

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Evaluate &mdash; unseen_open  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Preprocess" href="../2.Preprocess/2.Preprocess.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> unseen_open
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Whats-unseen.html">What is UNSEEN?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Workflow.html">UNSEEN-open</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">The workflow:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../1.Download/1.Retrieve.html">Retrieve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2.Preprocess/2.Preprocess.html">Preprocess</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Evaluate</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Set-up">Set up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Read-the-data-and-convert-the-time-column">Read the data and convert the time column</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Timeseries">Timeseries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Independence">Independence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Stability">Stability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Fidelity">Fidelity</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">unseen_open</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Evaluate</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/Notebooks/3.Evaluate/3.Evaluate.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Evaluate">
<h1>Evaluate<a class="headerlink" href="#Evaluate" title="Permalink to this headline">¶</a></h1>
<p>Can seasonal forecasts be used as ‘alternate’ realities? Here we show how a set of evaluation metrics can be used to answer this question. The evaluation metrics are available through an <a class="reference external" href="https://github.com/timokelder/UNSEEN">R package</a> for easy evaluation of the UNSEEN ensemble. Here, we illustrate how this package can be used in the UNSEEN workflow. We will evaluate the generated UNSEEN ensemble of UK February precipitation and of MAM Siberian heatwaves.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Note</p>
<p>This is R code and not python!</p>
<p>We switch to R since we believe R has a better functionality in extreme value statistics.</p>
</div>
<div class="section" id="Set-up">
<h2>Set up<a class="headerlink" href="#Set-up" title="Permalink to this headline">¶</a></h2>
<p>First, we set the working directory to the UNSEEN-open directory, then we load the UNSEEN and lubridate package. We need lubridate to convert the time class from character to Date.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">setwd</span><span class="p">(</span><span class="s">&#39;../../..&#39;</span><span class="p">)</span>
<span class="nf">getwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
'/lustre/soge1/projects/ls/personal/timo/UNSEEN-open'</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">library</span><span class="p">(</span><span class="n">UNSEEN</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Read-the-data-and-convert-the-time-column">
<h2>Read the data and convert the time column<a class="headerlink" href="#Read-the-data-and-convert-the-time-column" title="Permalink to this headline">¶</a></h2>
<p>The data that is imported here are the files stored at the end of step 1: Download, see for example <a class="reference external" href="https://nbviewer.jupyter.org/github/esowc/UNSEEN-open/blob/master/Notebooks/1.Download/1.5Upscale.ipynb">1.5</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">SEAS5_Siberia_events</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;Data/SEAS5_Siberia_events.csv&quot;</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">ERA5_Siberia_events</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;Data/ERA5_Siberia_events.csv&quot;</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">SEAS5_Siberia_events_zoomed</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;Data/SEAS5_Siberia_events_zoomed.csv&quot;</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">ERA5_Siberia_events_zoomed</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;Data/ERA5_Siberia_events_zoomed.csv&quot;</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">head</span><span class="p">(</span><span class="n">SEAS5_Siberia_events_zoomed</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="m">60</span><span class="p">)</span><span class="c1">#SEAS5_Siberia_events)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">ERA5_Siberia_events</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>A data.frame: 60 × 4</caption>
<thead>
    <tr><th></th><th scope=col>year</th><th scope=col>leadtime</th><th scope=col>number</th><th scope=col>t2m</th></tr>
    <tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope=row>1</th><td>1982</td><td>2</td><td> 0</td><td>269.4135</td></tr>
    <tr><th scope=row>2</th><td>1982</td><td>2</td><td> 1</td><td>267.4672</td></tr>
    <tr><th scope=row>3</th><td>1982</td><td>2</td><td> 2</td><td>268.9286</td></tr>
    <tr><th scope=row>4</th><td>1982</td><td>2</td><td> 3</td><td>266.7581</td></tr>
    <tr><th scope=row>5</th><td>1982</td><td>2</td><td> 4</td><td>269.6455</td></tr>
    <tr><th scope=row>6</th><td>1982</td><td>2</td><td> 5</td><td>267.9472</td></tr>
    <tr><th scope=row>7</th><td>1982</td><td>2</td><td> 6</td><td>268.7578</td></tr>
    <tr><th scope=row>8</th><td>1982</td><td>2</td><td> 7</td><td>267.4984</td></tr>
    <tr><th scope=row>9</th><td>1982</td><td>2</td><td> 8</td><td>270.1133</td></tr>
    <tr><th scope=row>10</th><td>1982</td><td>2</td><td> 9</td><td>269.1066</td></tr>
    <tr><th scope=row>11</th><td>1982</td><td>2</td><td>10</td><td>267.1255</td></tr>
    <tr><th scope=row>12</th><td>1982</td><td>2</td><td>11</td><td>269.3180</td></tr>
    <tr><th scope=row>13</th><td>1982</td><td>2</td><td>12</td><td>270.1963</td></tr>
    <tr><th scope=row>14</th><td>1982</td><td>2</td><td>13</td><td>268.2139</td></tr>
    <tr><th scope=row>15</th><td>1982</td><td>2</td><td>14</td><td>268.4484</td></tr>
    <tr><th scope=row>16</th><td>1982</td><td>2</td><td>15</td><td>269.4942</td></tr>
    <tr><th scope=row>17</th><td>1982</td><td>2</td><td>16</td><td>268.6117</td></tr>
    <tr><th scope=row>18</th><td>1982</td><td>2</td><td>17</td><td>267.6257</td></tr>
    <tr><th scope=row>19</th><td>1982</td><td>2</td><td>18</td><td>268.5591</td></tr>
    <tr><th scope=row>20</th><td>1982</td><td>2</td><td>19</td><td>266.7554</td></tr>
    <tr><th scope=row>21</th><td>1982</td><td>2</td><td>20</td><td>270.5969</td></tr>
    <tr><th scope=row>22</th><td>1982</td><td>2</td><td>21</td><td>265.1094</td></tr>
    <tr><th scope=row>23</th><td>1982</td><td>2</td><td>22</td><td>268.7506</td></tr>
    <tr><th scope=row>24</th><td>1982</td><td>2</td><td>23</td><td>267.0415</td></tr>
    <tr><th scope=row>25</th><td>1982</td><td>2</td><td>24</td><td>268.6641</td></tr>
    <tr><th scope=row>26</th><td>1982</td><td>2</td><td>25</td><td>      NA</td></tr>
    <tr><th scope=row>27</th><td>1982</td><td>2</td><td>26</td><td>      NA</td></tr>
    <tr><th scope=row>28</th><td>1982</td><td>2</td><td>27</td><td>      NA</td></tr>
    <tr><th scope=row>29</th><td>1982</td><td>2</td><td>28</td><td>      NA</td></tr>
    <tr><th scope=row>30</th><td>1982</td><td>2</td><td>29</td><td>      NA</td></tr>
    <tr><th scope=row>31</th><td>1982</td><td>2</td><td>30</td><td>      NA</td></tr>
    <tr><th scope=row>32</th><td>1982</td><td>2</td><td>31</td><td>      NA</td></tr>
    <tr><th scope=row>33</th><td>1982</td><td>2</td><td>32</td><td>      NA</td></tr>
    <tr><th scope=row>34</th><td>1982</td><td>2</td><td>33</td><td>      NA</td></tr>
    <tr><th scope=row>35</th><td>1982</td><td>2</td><td>34</td><td>      NA</td></tr>
    <tr><th scope=row>36</th><td>1982</td><td>2</td><td>35</td><td>      NA</td></tr>
    <tr><th scope=row>37</th><td>1982</td><td>2</td><td>36</td><td>      NA</td></tr>
    <tr><th scope=row>38</th><td>1982</td><td>2</td><td>37</td><td>      NA</td></tr>
    <tr><th scope=row>39</th><td>1982</td><td>2</td><td>38</td><td>      NA</td></tr>
    <tr><th scope=row>40</th><td>1982</td><td>2</td><td>39</td><td>      NA</td></tr>
    <tr><th scope=row>41</th><td>1982</td><td>2</td><td>40</td><td>      NA</td></tr>
    <tr><th scope=row>42</th><td>1982</td><td>2</td><td>41</td><td>      NA</td></tr>
    <tr><th scope=row>43</th><td>1982</td><td>2</td><td>42</td><td>      NA</td></tr>
    <tr><th scope=row>44</th><td>1982</td><td>2</td><td>43</td><td>      NA</td></tr>
    <tr><th scope=row>45</th><td>1982</td><td>2</td><td>44</td><td>      NA</td></tr>
    <tr><th scope=row>46</th><td>1982</td><td>2</td><td>45</td><td>      NA</td></tr>
    <tr><th scope=row>47</th><td>1982</td><td>2</td><td>46</td><td>      NA</td></tr>
    <tr><th scope=row>48</th><td>1982</td><td>2</td><td>47</td><td>      NA</td></tr>
    <tr><th scope=row>49</th><td>1982</td><td>2</td><td>48</td><td>      NA</td></tr>
    <tr><th scope=row>50</th><td>1982</td><td>2</td><td>49</td><td>      NA</td></tr>
    <tr><th scope=row>51</th><td>1982</td><td>2</td><td>50</td><td>      NA</td></tr>
    <tr><th scope=row>52</th><td>1982</td><td>3</td><td> 0</td><td>267.3054</td></tr>
    <tr><th scope=row>53</th><td>1982</td><td>3</td><td> 1</td><td>269.4579</td></tr>
    <tr><th scope=row>54</th><td>1982</td><td>3</td><td> 2</td><td>267.8808</td></tr>
    <tr><th scope=row>55</th><td>1982</td><td>3</td><td> 3</td><td>266.1220</td></tr>
    <tr><th scope=row>56</th><td>1982</td><td>3</td><td> 4</td><td>266.8159</td></tr>
    <tr><th scope=row>57</th><td>1982</td><td>3</td><td> 5</td><td>268.4771</td></tr>
    <tr><th scope=row>58</th><td>1982</td><td>3</td><td> 6</td><td>267.9680</td></tr>
    <tr><th scope=row>59</th><td>1982</td><td>3</td><td> 7</td><td>269.0933</td></tr>
    <tr><th scope=row>60</th><td>1982</td><td>3</td><td> 8</td><td>266.9857</td></tr>
</tbody>
</table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<table>
<caption>A data.frame: 6 × 2</caption>
<thead>
    <tr><th></th><th scope=col>year</th><th scope=col>t2m</th></tr>
    <tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope=row>1</th><td>1979</td><td>277.1607</td></tr>
    <tr><th scope=row>2</th><td>1980</td><td>277.0310</td></tr>
    <tr><th scope=row>3</th><td>1981</td><td>277.9729</td></tr>
    <tr><th scope=row>4</th><td>1982</td><td>277.9191</td></tr>
    <tr><th scope=row>5</th><td>1983</td><td>277.9752</td></tr>
    <tr><th scope=row>6</th><td>1984</td><td>277.6508</td></tr>
</tbody>
</table></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">EOBS_UK_weighted_df</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;Data/EOBS_UK_weighted_upscaled.csv&quot;</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">SEAS5_UK_weighted_df</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;Data/SEAS5_UK_weighted_masked.csv&quot;</span><span class="p">,</span> <span class="n">stringsAsFactors</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And then convert the time class to Date format, with the ymd function in lubridate:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">EOBS_UK_weighted_df</span><span class="o">$</span><span class="n">time</span> <span class="o">&lt;-</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">ymd</span><span class="p">(</span><span class="n">EOBS_UK_weighted_df</span><span class="o">$</span><span class="n">time</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="n">EOBS_UK_weighted_df</span><span class="p">)</span>

<span class="n">SEAS5_UK_weighted_df</span><span class="o">$</span><span class="n">time</span> <span class="o">&lt;-</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">ymd</span><span class="p">(</span><span class="n">SEAS5_UK_weighted_df</span><span class="o">$</span><span class="n">time</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="n">SEAS5_UK_weighted_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;data.frame&#39;:   71 obs. of  2 variables:
 $ time: Date, format: &#34;1950-02-28&#34; &#34;1951-02-28&#34; ...
 $ rr  : num  4.13 3.25 1.07 1.59 2.59 ...
&#39;data.frame&#39;:   4375 obs. of  4 variables:
 $ leadtime: int  2 2 2 2 2 2 2 2 2 2 ...
 $ number  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ time    : Date, format: &#34;1982-02-01&#34; &#34;1983-02-01&#34; ...
 $ tprate  : num  1.62 2.93 3.27 2 3.31 ...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="n">SEAS5_Siberia_events</span><span class="o">$</span><span class="n">year</span> <span class="o">&lt;-</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">ymd</span><span class="p">(</span><span class="n">SEAS5_Siberia_events</span><span class="o">$</span><span class="n">year</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="n">SEAS5_Siberia_events</span><span class="p">)</span>

<span class="n">ERA5_Siberia_events</span><span class="o">$</span><span class="n">year</span> <span class="o">&lt;-</span> <span class="n">lubridate</span><span class="o">::</span><span class="nf">ymd</span><span class="p">(</span><span class="n">ERA5_Siberia_events</span><span class="o">$</span><span class="n">year</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="n">ERA5_Siberia_events</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning message:
“All formats failed to parse. No formats found.”
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;data.frame&#39;:   2625 obs. of  4 variables:
 $ year    : Date, format: NA NA ...
 $ leadtime: int  2 2 2 2 2 2 2 2 2 2 ...
 $ number  : int  0 1 2 3 4 5 6 7 8 9 ...
 $ t2m     : num  278 277 277 276 278 ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning message:
“All formats failed to parse. No formats found.”
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;data.frame&#39;:   42 obs. of  2 variables:
 $ year: Date, format: NA NA ...
 $ t2m : num  277 277 278 278 278 ...
</pre></div></div>
</div>
<div class="section" id="Timeseries">
<h3>Timeseries<a class="headerlink" href="#Timeseries" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">unseen_timeseries</span><span class="p">(</span>
    <span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_Siberia_events_zoomed</span><span class="p">,</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">ERA5_Siberia_events_zoomed</span><span class="p">,</span>
    <span class="n">ensemble_yname</span> <span class="o">=</span> <span class="s">&quot;t2m&quot;</span><span class="p">,</span>
    <span class="n">ensemble_xname</span> <span class="o">=</span> <span class="s">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">obs_yname</span> <span class="o">=</span> <span class="s">&quot;t2m&quot;</span><span class="p">,</span>
    <span class="n">obs_xname</span> <span class="o">=</span> <span class="s">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">ylab</span> <span class="o">=</span> <span class="s">&quot;MAM Siberian temperature&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning message:
“Removed 2756 rows containing non-finite values (stat_boxplot).”
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Notebooks_3.Evaluate_3.Evaluate_14_1.png" class="no-scaled-link" src="../../_images/Notebooks_3.Evaluate_3.Evaluate_14_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">unseen_timeseries</span><span class="p">(</span><span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_UK_weighted_df</span><span class="p">,</span> <span class="n">obs</span> <span class="o">=</span> <span class="n">EOBS_UK_weighted_df</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&#39;UK February precipitation (mm/d)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Notebooks_3.Evaluate_3.Evaluate_15_0.png" class="no-scaled-link" src="../../_images/Notebooks_3.Evaluate_3.Evaluate_15_0.png" style="width: 420px; height: 420px;" />
</div>
</div>
<p>Call the documentation of the function with <code class="docutils literal notranslate"><span class="pre">?unseen_timeseries</span></code></p>
</div>
<div class="section" id="Independence">
<h3>Independence<a class="headerlink" href="#Independence" title="Permalink to this headline">¶</a></h3>
<p>Significance ranges need fixing + detrend method (Rob)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">independence_test</span><span class="p">(</span>
    <span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_Siberia_events_zoomed</span><span class="p">,</span>
    <span class="n">n_lds</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span>
    <span class="n">var_name</span> <span class="o">=</span> <span class="s">&quot;t2m&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning message:
“Removed 975 rows containing non-finite values (stat_ydensity).”
Warning message:
“Removed 975 rows containing non-finite values (stat_boxplot).”
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Notebooks_3.Evaluate_3.Evaluate_19_1.png" class="no-scaled-link" src="../../_images/Notebooks_3.Evaluate_3.Evaluate_19_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">independence_test</span><span class="p">(</span><span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_UK</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning message:
“Removed 1625 rows containing non-finite values (stat_ydensity).”
Warning message:
“Removed 1625 rows containing non-finite values (stat_boxplot).”
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Notebooks_3.Evaluate_3.Evaluate_20_1.png" class="no-scaled-link" src="../../_images/Notebooks_3.Evaluate_3.Evaluate_20_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
</div>
<div class="section" id="Stability">
<h3>Stability<a class="headerlink" href="#Stability" title="Permalink to this headline">¶</a></h3>
<p>Na.rm = True needed</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">stability_test</span><span class="p">(</span>
    <span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_Siberia_events_zoomed</span><span class="p">,</span>
    <span class="n">lab</span> <span class="o">=</span> <span class="s">&#39;MAM Siberian temperature&#39;</span><span class="p">,</span>
    <span class="n">var_name</span> <span class="o">=</span> <span class="s">&#39;t2m&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error in quantile.default(newX[, i], ...): missing values and NaN&#39;s not allowed if &#39;na.rm&#39; is FALSE
Traceback:

1. stability_test(ensemble = SEAS5_Siberia_events_zoomed, lab = &#34;MAM Siberian temperature&#34;,
 .     var_name = &#34;t2m&#34;)
2. Model_stability_boot(ensemble = ensemble, var_name = var_name,
 .     ld_name = ld_name, lab = lab)
3. apply(bootstrapped_array, MARGIN = 2, FUN = stats::quantile,
 .     probs = 1 - 1/(rps))
4. FUN(newX[, i], ...)
5. quantile.default(newX[, i], ...)
6. stop(&#34;missing values and NaN&#39;s not allowed if &#39;na.rm&#39; is FALSE&#34;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">stability_test</span><span class="p">(</span><span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_UK</span><span class="p">,</span> <span class="n">lab</span> <span class="o">=</span> <span class="s">&#39;UK February precipitation (mm/d)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Warning message:
“Removed 4 row(s) containing missing values (geom_path).”
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Notebooks_3.Evaluate_3.Evaluate_24_1.png" class="no-scaled-link" src="../../_images/Notebooks_3.Evaluate_3.Evaluate_24_1.png" style="width: 420px; height: 420px;" />
</div>
</div>
</div>
<div class="section" id="Fidelity">
<h3>Fidelity<a class="headerlink" href="#Fidelity" title="Permalink to this headline">¶</a></h3>
<p>Unit is incorrect + na.rm = False (needs to be true) -&gt; needs fixing</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">fidelity_test</span><span class="p">(</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">ERA5_Siberia_events_zoomed</span><span class="o">$</span><span class="n">t2m</span><span class="p">,</span>
    <span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_Siberia_events_zoomed</span><span class="o">$</span><span class="n">t2m</span><span class="p">,</span>
    <span class="n">biascor</span> <span class="o">=</span> <span class="kc">TRUE</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Error in quantile.default(bootstrapped_fun, probs = c(0.025, 0.975)): missing values and NaN&#39;s not allowed if &#39;na.rm&#39; is FALSE
Traceback:

1. fidelity_test(obs = ERA5_Siberia_events_zoomed$t2m, ensemble = SEAS5_Siberia_events_zoomed$t2m,
 .     biascor = TRUE)
2. ggpubr::ggarrange(p1_comb, p2_comb, p3_comb, p4_comb, labels = c(&#34;a&#34;,
 .     &#34;b&#34;, &#34;c&#34;, &#34;d&#34;), font.label = list(size = fontsize, color = &#34;black&#34;,
 .     face = &#34;bold&#34;, family = NULL), ncol = 2, nrow = 2)
3. purrr::map(plots, .plot_grid, ncol = ncol, nrow = nrow, labels = labels,
 .     label_size = .lab$size, label_fontfamily = .lab$family, label_fontface = .lab$face,
 .     label_colour = .lab$color, label_x = .lab$label.x, label_y = .lab$label.y,
 .     hjust = .lab$hjust, vjust = .lab$vjust, align = align, rel_widths = widths,
 .     rel_heights = heights, legend = legend, common.legend.grob = legend.grob)
4. .f(.x[[i]], ...)
5. cowplot::plot_grid(plotlist = plotlist, ...)
6. align_plots(plotlist = plots, align = align, axis = axis, greedy = greedy)
7. lapply(plots, function(x) {
 .     if (!is.null(x))
 .         as_gtable(x)
 .     else NULL
 . })
8. FUN(X[[i]], ...)
9. as_gtable(x)
10. as_gtable.default(x)
11. as_grob(plot)
12. as_grob.ggplot(plot)
13. ggplot2::ggplotGrob(plot)
14. ggplot_gtable(ggplot_build(x))
15. ggplot_build(x)
16. ggplot_build.ggplot(x)
17. by_layer(function(l, d) l$compute_aesthetics(d, plot))
18. f(l = layers[[i]], d = data[[i]])
19. l$compute_aesthetics(d, plot)
20. f(..., self = self)
21. lapply(aesthetics, eval_tidy, data = data, env = env)
22. FUN(X[[i]], ...)
23. stats::quantile(bootstrapped_fun, probs = c(0.025, 0.975))
24. quantile.default(bootstrapped_fun, probs = c(0.025, 0.975))
25. stop(&#34;missing values and NaN&#39;s not allowed if &#39;na.rm&#39; is FALSE&#34;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">fidelity_test</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="n">EOBS_UK</span><span class="o">$</span><span class="n">rr</span><span class="p">,</span> <span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_UK</span><span class="o">$</span><span class="n">tprate</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Notebooks_3.Evaluate_3.Evaluate_28_0.png" class="no-scaled-link" src="../../_images/Notebooks_3.Evaluate_3.Evaluate_28_0.png" style="width: 420px; height: 420px;" />
</div>
</div>
<p>To include a mean-bias correction, set <code class="docutils literal notranslate"><span class="pre">biascor</span> <span class="pre">=</span> <span class="pre">TRUE</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="nf">fidelity_test</span><span class="p">(</span><span class="n">obs</span> <span class="o">=</span> <span class="n">EOBS_UK</span><span class="o">$</span><span class="n">rr</span><span class="p">,</span> <span class="n">ensemble</span> <span class="o">=</span> <span class="n">SEAS5_UK</span><span class="o">$</span><span class="n">tprate</span><span class="p">,</span> <span class="n">biascor</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/Notebooks_3.Evaluate_3.Evaluate_30_0.png" class="no-scaled-link" src="../../_images/Notebooks_3.Evaluate_3.Evaluate_30_0.png" style="width: 420px; height: 420px;" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">?</span><span class="n">fidelity_test</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../2.Preprocess/2.Preprocess.html" class="btn btn-neutral float-left" title="Preprocess" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Timo Kelder

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>